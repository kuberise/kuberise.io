# ADR-0006: Configurable Team Label on ArgoCD Applications

## Status

Accepted

## Context

All ArgoCD Applications generated by the app-of-apps template had a hard-coded `team: platform` label. As the platform grows to support multiple teams, a fixed label prevents team-based filtering, access control, and operational routing.

## Decision

The `team` label is now configurable per application via the `team` field, defaulting to `platform` when omitted:

```yaml
team: {{ default "platform" $app.team }}
```

Example applications have been updated with team assignments: `frontend` for user-facing apps (`show-env`, `frontend-https`, `grpc-server`) and `backend` for service-layer apps (`backend`, `api`). All platform components continue to default to `platform` without any values change.

### Use cases enabled

#### 1. ArgoCD RBAC scoping

ArgoCD role-based access control can restrict which teams can view, sync, or manage which applications based on the team label, enforcing least-privilege access.

#### 2. ArgoCD UI filtering

The ArgoCD dashboard supports label-based filtering. Team labels let developers filter to only their team's applications instead of scrolling through all platform components.

#### 3. Grafana dashboard filtering

ArgoCD exports metrics with application labels. Team labels enable Grafana dashboards filtered by team, e.g., "show sync status and health for all `team: frontend` applications."

#### 4. Alert routing

Alertmanager or external incident management tools (Opsgenie, PagerDuty) can route ArgoCD sync failure alerts to the correct team's channel based on the label.

#### 5. Cost allocation

Combined with OpenCost, team labels help attribute infrastructure costs to the team that owns each application.

#### 6. Multi-team platform operation

As operations scale beyond a single platform team, the label enables natural grouping:
- `team: platform` -- core infrastructure (cert-manager, ingress, monitoring)
- `team: data` -- database, redis, minio
- `team: security` -- keycloak, vault, kyverno
- `team: frontend` / `team: backend` -- developer applications

## Consequences

- All existing applications continue to work unchanged (default is `platform`).
- New applications can specify `team: <name>` in their values to assign ownership.
- The label is a Kubernetes label on the ArgoCD Application resource, making it queryable via `kubectl` and the ArgoCD API.
